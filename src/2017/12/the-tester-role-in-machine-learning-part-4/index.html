<!DOCTYPE html>
<html lang="en-US">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="profile" href="http://gmpg.org/xfn/11">
				<link rel="pingback" href="/xmlrpc.php">
				<title>The Tester Role in Machine Learning, Part 4 &#8211; Stories from a Software Tester</title>
<meta name="robots" content="max-image-preview:large">
 <style type="text/css" class="darkmysite_inline_css">:root { --darkmysite_dark_mode_bg: #0f0f0f; --darkmysite_dark_mode_secondary_bg: #171717; --darkmysite_dark_mode_text_color: #bebebe; --darkmysite_dark_mode_link_color: #ffffff; --darkmysite_dark_mode_link_hover_color: #cccccc; --darkmysite_dark_mode_input_bg: #2d2d2d; --darkmysite_dark_mode_input_text_color: #bebebe; --darkmysite_dark_mode_input_placeholder_color: #989898; --darkmysite_dark_mode_border_color: #4a4a4a; --darkmysite_dark_mode_btn_bg: #2d2d2d; --darkmysite_dark_mode_btn_text_color: #bebebe; }</style> <style type="text/css" class="darkmysite_inline_css">.darkmysite_dark_mode_enabled::-webkit-scrollbar { background: #29292a !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-track { background: #29292a !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-thumb { background-color: #52565a !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-corner { background-color: #52565a !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-button { background-color: transparent !important; background-repeat: no-repeat !important; background-size: contain !important; background-position: center !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-button:start { background-image: url(/wp-content/plugins/darkmysite/assets/img/others/scroll_arrow_up.svg) !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-button:end { background-image: url(/wp-content/plugins/darkmysite/assets/img/others/scroll_arrow_down.svg) !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-button:start:horizontal { background-image: url(/wp-content/plugins/darkmysite/assets/img/others/scroll_arrow_left.svg) !important; } .darkmysite_dark_mode_enabled::-webkit-scrollbar-button:end:horizontal { background-image: url(/wp-content/plugins/darkmysite/assets/img/others/scroll_arrow_right.svg) !important; }</style> <script type="text/javascript" class="darkmysite_inline_js">var darkmysite_switch_unique_id = "1245862394"; var darkmysite_is_this_admin_panel = "0"; var darkmysite_enable_default_dark_mode = "0"; var darkmysite_enable_os_aware = "1"; var darkmysite_enable_keyboard_shortcut = "1"; var darkmysite_enable_time_based_dark = "0"; var darkmysite_time_based_dark_start = "19:00"; var darkmysite_time_based_dark_stop = "07:00"; var darkmysite_alternative_dark_mode_switch = ""; var darkmysite_enable_low_image_brightness = "1"; var darkmysite_image_brightness_to = "80"; var darkmysite_enable_image_grayscale = "0"; var darkmysite_image_grayscale_to = "80"; var darkmysite_enable_bg_image_darken = "1"; var darkmysite_bg_image_darken_to = "60"; var darkmysite_enable_invert_inline_svg = "0"; var darkmysite_enable_low_video_brightness = "1"; var darkmysite_video_brightness_to = "80"; var darkmysite_enable_video_grayscale = "0"; var darkmysite_video_grayscale_to = "80"; var darkmysite_disallowed_elements = ".darkmysite_ignore, .darkmysite_ignore *, .darkmysite_switch, .darkmysite_switch *, .wp-block-button__link, .wp-block-button__link *";</script><link rel="dns-prefetch" href="//static.addtoany.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="alternate" type="application/rss+xml" title="Stories from a Software Tester &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="Stories from a Software Tester &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Stories from a Software Tester &raquo; The Tester Role in Machine Learning, Part 4 Comments Feed" href="/2017/12/the-tester-role-in-machine-learning-part-4/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.2.2"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){p.clearRect(0,0,i.width,i.height),p.fillText(e,0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(t,0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s("🏳️‍⚧️","🏳️​⚧️")?!1:!s("🇺🇳","🇺​🇳")&&!s("🏴󠁧󠁢󠁥󠁮󠁧󠁿","🏴​󠁧​󠁢​󠁥​󠁮​󠁧​󠁿");case"emoji":return!s("🫱🏻‍🫲🏿","🫱🏻​🫲🏿")}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="urvanov_syntax_highlighter-css" href="/wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css?ver=2.8.33" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="/wp-content/plugins/urvanov-syntax-highlighter/themes/classic/classic.css?ver=2.8.33" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="/wp-content/plugins/urvanov-syntax-highlighter/fonts/monaco.css?ver=2.8.33" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.2.2" type="text/css" media="all">
<style id="wp-block-library-theme-inline-css" type="text/css">.wp-block-audio figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio figcaption{color:hsla(0,0%,100%,.65)}.wp-block-audio{margin:0 0 1em}.wp-block-code{border:1px solid #ccc;border-radius:4px;font-family:Menlo,Consolas,monaco,monospace;padding:.8em 1em}.wp-block-embed figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed figcaption{color:hsla(0,0%,100%,.65)}.wp-block-embed{margin:0 0 1em}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:hsla(0,0%,100%,.65)}.wp-block-image figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-image figcaption{color:hsla(0,0%,100%,.65)}.wp-block-image{margin:0 0 1em}.wp-block-pullquote{border-bottom:4px solid;border-top:4px solid;color:currentColor;margin-bottom:1.75em}.wp-block-pullquote cite,.wp-block-pullquote footer,.wp-block-pullquote__citation{color:currentColor;font-size:.8125em;font-style:normal;text-transform:uppercase}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;font-style:normal;position:relative}.wp-block-quote.has-text-align-right{border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote.has-text-align-center{border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large,.wp-block-quote.is-style-plain{border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-search__button{border:1px solid #ccc;padding:.375em .625em}:where(.wp-block-group.has-background){padding:1.25em 2.375em}.wp-block-separator.has-css-opacity{opacity:.4}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto}.wp-block-separator.has-alpha-channel-opacity{opacity:1}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table{margin:0 0 1em}.wp-block-table td,.wp-block-table th{word-break:normal}.wp-block-table figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table figcaption{color:hsla(0,0%,100%,.65)}.wp-block-video figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video figcaption{color:hsla(0,0%,100%,.65)}.wp-block-video{margin:0 0 1em}.wp-block-template-part.has-background{margin-bottom:0;margin-top:0;padding:1.25em 2.375em}</style>
<link rel="stylesheet" id="classic-theme-styles-css" href="/wp-includes/css/classic-themes.min.css?ver=6.2.2" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="darkmysite-client-main-css" href="/wp-content/plugins/darkmysite/assets/css/client_main.css?ver=1.2.6" type="text/css" media="all">
<link rel="stylesheet" id="plyr-css-css" href="/wp-content/plugins/easy-video-player/lib/plyr.css?ver=6.2.2" type="text/css" media="all">
<link rel="stylesheet" id="acuarela-fonts-css" href="https://fonts.googleapis.com/css?family=Lato%3A300italic%2C400italic%2C700italic%2C300%2C400%2C700%7CArima+Madurai%3A700%2C800%7CInconsolata%3A400%2C700&#038;subset=latin%2Clatin-ext&#038;ver=20190802" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="/wp-content/themes/acuarela/genericons/genericons.css?ver=3.4.1" type="text/css" media="all">
<link rel="stylesheet" id="animate-css" href="/wp-content/themes/acuarela/css/animate.css?ver=3.7.2" type="text/css" media="all">
<link rel="stylesheet" id="acuarela-style-css" href="/wp-content/themes/acuarela/style.css?ver=6.2.2" type="text/css" media="all">
<link rel="stylesheet" id="addtoany-css" href="/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.16" type="text/css" media="all">
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.6.4" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.0" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.33","is_admin":"0","ajaxurl":"\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.33" id="urvanov_syntax_highlighter_js-js"></script>
<script type="text/javascript" id="addtoany-core-js-before">window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};</script>
<script type="text/javascript" async src="https://static.addtoany.com/menu/page.js" id="addtoany-core-js"></script>
<script type="text/javascript" async src="/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1" id="addtoany-jquery-js"></script>
<script type="text/javascript" src="/wp-content/plugins/darkmysite/assets/js/client_main.js?ver=1.2.6" id="darkmysite-client-main-js"></script>
<script type="text/javascript" id="plyr-js-js-extra">
/* <![CDATA[ */
var easy_video_player = {"plyr_iconUrl":"\/wp-content\/plugins\/easy-video-player\/lib\/plyr.svg","plyr_blankVideo":"\/wp-content\/plugins\/easy-video-player\/lib\/blank.mp4"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/easy-video-player/lib/plyr.js?ver=6.2.2" id="plyr-js-js"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/3242">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 6.2.2">
<link rel="canonical" href="/2017/12/the-tester-role-in-machine-learning-part-4/">
<link rel="shortlink" href="/?p=3242">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2017%2F12%2Fthe-tester-role-in-machine-learning-part-4%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2017%2F12%2Fthe-tester-role-in-machine-learning-part-4%2F#038;format=xml">
<link type="text/css" rel="stylesheet" href="/wp-content/plugins/category-specific-rss-feed-menu/wp_cat_rss_style.css">
<!--Custom Styling-->
<style media="screen" type="text/css">.site-description { color: #222222}
.site-title, .entry-title, .post-title, .widget-title, .posts-navigation .nav-links { font-family: Arima Madurai}
 body { font-family: Lato}</style>
	<style id="acuarela-header-css" type="text/css"></style>
<style type="text/css" id="custom-background-css">body.custom-background { background-image: url("/wp-content/uploads/2020/10/low_contrast_linen.png"); background-position: left top; background-size: cover; background-repeat: no-repeat; background-attachment: fixed; }</style>
			<style type="text/css" id="wp-custom-css">@font-face {
  font-family: "Open Sans";
  font-weight: 400;
  font-style: normal;
  src: local("Open Sans Regular"), local("OpenSans-Regular"), url("/fonts/OpenSans-Regular.woff") format("woff");
}

@font-face {
  font-family: "Open Sans Bold";
  font-weight: 700;
  font-style: normal;
  src: local("Open Sans Bold"), local("OpenSans-Bold"), url("/fonts/OpenSans-Bold.woff") format("woff");
}

@font-face {
  font-family: "Open Sans Italic";
  font-weight: 400;
  font-style: normal;
  src: local("Open Sans Italic"), local("OpenSans-Italic"), url("/fonts/OpenSans-Italic.woff") format("woff");
}

:root{
	--primary: #01408e;
	--secondary: #3c5d5c;
	--initialLine: #ad2271;
	--drop: #903;
	--paraIndent: 1.25em;
	--note: #4d5b7c;
	--bq-color: #555555;
	--bq-back: #ededed;
	--sans: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
	--mono: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
    "Courier New", monospace;
}
/* For the top menu bar. */
.site-navigation a {
	padding: 0.9em 1.5em;
}

:where(html, body) {
	overscroll-behavior-y: none;
	cursor: url("/cursors/default.cur"), auto;
}

:where(p, h1, h2, h3, h4, h5, h6, blockquote, figcaption) {
	cursor: url("/cursors/text-select.cur"), auto;
}

:where(ul, ol) {
	margin: 1em 1em;
	text-align: justify;
	text-justify: inter-word;
	cursor: url("/cursors/text-select.cur"), auto;
}

:where(aside, article) a {
	cursor: url("/cursors/link-select.cur"), auto;
}

select, button, input,
.wp-element-button,
.darkmysite_switch,
.site-title,
.site-description {
	cursor: url("/cursors/link-select.cur"), auto;
}

::selection {
  color: #fff;
  background: rgba(0, 0, 0, 0.99);
}

main,
header {
	font-size: 1rem;
}

main {
	/*From here: https://fluidtypography.com/#app-get-started*/
	/* Settings: 414-1280; 16-20; 1.6-1.3*/
	font-size: clamp(1rem, 0.462vw + 0.88rem, 1.25rem);
line-height: clamp(1.6rem, 0.046vw + 1.588rem, 1.625rem);
}

article {
	font-family: var(--sans);
	line-height: 1.6;
  word-spacing: 0.16em;
}

h1:not(.site-title) {
  font-size: 2.5em;
  margin: 0.67em 0;
  text-align: center;
}

:where(h1, h2, h3, h4) {
	text-rendering: optimizeLegibility;
	line-height: 1.4em;
}

article :where(h2, h3) {
	margin-bottom: 0.7em;
}

p {
	font-size: 1.2em;
	text-align: justify;
	text-justify: inter-word;
}

p:first-of-type:first-line {
	color: var(--initialLine);
}

li {
  margin-bottom: 0.5em;
}

/* This makes sure the first line of blockquotes are not colored since in Wordpress, a blockquote content has a paragraph tag applied to it. */
:where(blockquote, footer, .comments-area) p:first-of-type:first-line {
	color: inherit;
}
:where(p, blockquote, img, pre, ul, ol) + p:not(.note) {
  text-indent: var(--paraIndent);
}
section > h3 + p::first-letter,
section > h2 + p::first-letter,
div.entry-content > p:not(.nostyle):first-child::first-letter {
	color: var(--drop);
  border-left: 2px solid var(--drop);
  border-top: 2px solid var(--drop);
  float: left;
  font-family: Georgia;
  font-size: 65px;
  line-height: 60px;
  padding-top: 4px;
  padding-right: 12px;
  padding-left: 3px;
}

:where(aside, article) a {
	color: var(--primary);
	text-underline-position: under;
	text-decoration: underline 2px;
	transition: all 0.3s linear;
  background: linear-gradient(to right, #00d1b1 0%, #278fc6 98%);
  background-size: 0px 2px;
  background-repeat: no-repeat;
  background-position: left 10%;
  text-shadow: 0;
}

article a:hover {
  background-size: 100% 2px;
  color: var(--secondary);
}

article a:focus {
  color: var(--secondary);
}

/* Handling external links to show an icon after them, but excluding links that are part of the TesterStories site. */

a[href*="http"]::after,
a[href*="https"]::after {
  content: "";
  width: 16px;
  height: 16px;
  margin-left: 4px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z'/%3E%3Cpath fill-rule='evenodd' d='M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
  display: inline-block;
}

a[href^="https://www.linkedin.com/"]::after {
  content: none;
}

a[href^="https://testerstories.com/"]::after {
  display: none !important;
}

img.framed {
  --b: 10px;
  margin: 0 auto;
  padding: var(--b);
  border: calc(2 * var(--b)) solid #0000;
  border-radius: 25px;
  outline: 1px solid #000;
  outline-offset: calc(-1 * var(--b));
  background: conic-gradient(from 90deg at 1px 1px, #0000 90deg, #000 0);
}

img.backframed {
  margin: 0 auto;
  border: 3px solid black;
  box-shadow: -50px -50px 0 -40px #555555, 50px 50px 0 -40px #555555;
}

.note {
  border: 1px solid rgb(107, 113, 177);
  color: var(--note);
  border-radius: 16px;
  padding: 0.5em 0.8em;
  margin: 1.9em;
}

.post {
	background-color: white;
}

.entry-content li {
	font-size: 1.2em;
}

.simplequote {
	background: #fff url(/2017/12/the-tester-role-in-machine-learning-part-4/images/box_quote.png) no-repeat;
	padding: 5px;
	margin-top: 20px; margin-bottom: 20px;
	margin-left: 50px; margin-right: 50px;
	border: 3px solid #cecece;
	text-indent: 25px;
}

p.example {
	padding: 1ex;
	margin-right: 50px; margin-left: 50px;
	border: .5ex solid #808080;
	color: #000000;
	line-height: 1.2;
	text-indent: 0em;
}

#headquote blockquote {
	text-align: left;
	margin: 0 auto 20px auto;
	color: #555;
	background: #eee url(/2017/12/the-tester-role-in-machine-learning-part-4/images/quote_top.gif) no-repeat top left;
}

#headquote blockquote {
	width: 370px;
	font-size: 110%;
	letter-spacing: -1px;
	line-height: 1.2em;
}

#headquote #quote {
	margin-left: 40px;
	padding: 20px 20px 10px 20px;
	background: url(/2017/12/the-tester-role-in-machine-learning-part-4/images/quote_bottom.gif) no-repeat right bottom;
}

#headquote #author {
	margin: 0;
	text-align: center;
	padding: 0 0 10px 0;
	color: #999;
	font-size: 95%;
}

#headquote blockquote strong {
	color: #000;
	font-weight: normal;
}

/* Center images. */

img {
	display: block;
  margin: 0 auto;
}

img.smaller {
  width: 200px;
}

img.even-smaller {
  width: 100px;
}

table td.code {
  font-family: "Courier New", courier, monospace;
  font-size: 11.5px;
}

p.box {
	font-family: Georgia, "Times New Roman", Times, serif;
	text-align: justify;
	padding-top: 25px;
	margin: 0;
	line-height: 1.2;
}

pre.box {
	white-space: pre-wrap;
	background-color: white;
	border: 1px solid;
}

p.tip {
	padding-bottom: 10px; padding-top: 10px;
	padding-right: 10px; padding-left: 10px;
	border: 1px solid;
}

div.aside {
	padding-bottom: 10px; padding-top: 10px;
	padding-right: 10px; padding-left: 10px;
	margin-right: 50px; margin-left: 50px;
	border: 1px dotted;
}

div.aside pre {
	white-space: pre-wrap;
}

pre.view {
	font-family: "Courier New", Courier, monospace;
        //font-size: 16px;
	padding-bottom: 10px; padding-top: 10px;
	padding-right: 10px; padding-left: 10px;
	white-space: pre-wrap;
	background: rgb(255,255,255); /* Old browsers */
	background: -moz-linear-gradient(top,  rgba(255,255,255,1) 0%, rgba(229,229,229,1) 100%); /* FF3.6+ */
	background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,1)), color-stop(100%,rgba(229,229,229,1))); /* Chrome,Safari4+ */
	background: -webkit-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(229,229,229,1) 100%); /* Chrome10+,Safari5.1+ */
	background: -o-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(229,229,229,1) 100%); /* Opera 11.10+ */
	background: -ms-linear-gradient(top,  rgba(255,255,255,1) 0%,rgba(229,229,229,1) 100%); /* IE10+ */
	background: linear-gradient(to bottom,  rgba(255,255,255,1) 0%,rgba(229,229,229,1) 100%); /* W3C */
	filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e5e5e5',GradientType=0 ); /* IE6-9 */
	border: 1px solid;
	text-align: justify;
}

pre.view .string {
	color: #3366CC;
}

pre.view .sub {
        color: #8333FF;
}

pre.view .comment {
	color: #009900;
}

pre.view .highlight {
	background-color: #FFFF00;
	border: 1px solid;
	border-style: dotted;
}

pre.output .highlight {
	background-color: rgb(255,255,255);
	color: red;
	border: 1px solid;
	border-style: dotted;
}

pre.output {
	font-family: "Courier New", Courier, monospace;
        //font-size: 16px;
	padding-bottom: 10px; padding-top: 10px;
	padding-right: 10px; padding-left: 10px;
	white-space: pre-wrap;
	background: black;
	color: white;
}

blockquote {
  position: relative;
  width: 80%;
  margin: 50px auto;
  padding: 1.2em 30px 1.2em 55px;
  color: var(--bq-color);
  background-color: var(--bq-back);
  border-left: 8px solid #78c0a8;
  text-align: justify;
}

blockquote::before {
  position: absolute;
	left: 5px;
	top: -10px;
	/* Line height needed here to avoid the quote appearing out of place due to calculated line heights for the article. */
	line-height: 1.6;
	content: "\201C";
	color: #78c0a8;
	font-size: 4em;
}

blockquote::after {
	content: "";
}

blockquote span {
	display: block;
	color: #333333;
	font-style: normal;
  font-weight: bold;
  margin-top: 1em;
}

img.frame {
  --b: 10px;
  padding: var(--b);
  border: calc(2 * var(--b)) solid #0000;
  outline: 1px solid #000;
  outline-offset: calc(-1 * var(--b));
  border-radius: 25px;
  background: conic-gradient(from 90deg at 1px 1px, #0000 90deg, #000 0);
  display: block;
  margin: auto;
  margin-bottom: 1rem;
}

code {
  font-size: 0.9em;
  padding: 0.0625rem 0.5rem;
  border-radius: 0.125rem;
  border: 1px solid #d33a2c;
  box-shadow: 1px 1px #d33a2c, 2px 2px #d33a2c;
  margin: 0 0.25rem;
  color: #d33a2c;
  font-family: monospace;
}

pre {
  font-family: var(--mono);
  max-width: 100%;
	padding: 0;
}

pre code {
  word-spacing: normal;
  letter-spacing: normal;
  font-family: var(--mono);
  padding-left: 10px;
  color: #e9e9f4;
  background: #282936;
  display: block;
  max-width: 100%;
  overflow-x: scroll;
  /*font-size: 0.8em;*/

  border: 1px solid #282936;
  border-radius: 10px;
  box-shadow: 1px 1px #282936, 2px 2px #282936;
}

pre code::-webkit-scrollbar {
  -webkit-appearance: none;
  appearance: none;
}

pre code::-webkit-scrollbar:vertical {
  width: 11px;
}

pre code::-webkit-scrollbar:horizontal {
  height: 11px;
}

pre code::-webkit-scrollbar-thumb {
  border-radius: 8px;
  border: 2px solid white;
  background-color: rgba(0, 0, 0, 0.5);
}

/* The div part is only needed for long-form content that is pre-formatted. */

pre code div {
	line-height: 1.5em;
}

/* This would be for prefromatted material that is not literally from a game or simulation but is meant to indicate something about the details of the game or simulation. */

pre p {
  border: 2px solid grey;
  border-radius: 5px;
  padding: 0.8em;
	padding-top: 0;
	margin: 0;
}</style>
			</head>
	<body class="post-template-default single single-post postid-3242 single-format-standard custom-background wp-embed-responsive custom-background-image">
		<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0.49803921568627"></fefuncr><fefuncg type="table" tablevalues="0 0.49803921568627"></fefuncg><fefuncb type="table" tablevalues="0 0.49803921568627"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 0.27843137254902"></fefuncg><fefuncb type="table" tablevalues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0"></fefuncr><fefuncg type="table" tablevalues="0 0.64705882352941"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.78039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.94901960784314"></fefuncg><fefuncb type="table" tablevalues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.098039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.66274509803922"></fefuncg><fefuncb type="table" tablevalues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg>		<div id="container" class="site container">
	<header id="masthead" class="site-header animated fadeInDown" role="banner">

	<a class="screen-reader-text skip-link" href="#main-content">Skip to content</a>
	<a class="screen-reader-text skip-link" href="#sidebar-widget-area">Skip to sidebar</a>
	<a class="screen-reader-text skip-link" href="#page-footer">Skip to footer</a>
	<div id="site-identity" class="site-identity">
		<a href="/" class="home-link animated fadeIn" title="Stories from a Software Tester" rel="home">
			<div class="title-description">
				<h1 class="site-title">Stories from a Software Tester</h1>
				<h2 class="site-description">Twice upon a time, in another space, no distance in any direction from here &#8230;</h2>
			</div>
		</a> 

	</div>
<!--/site-identity-->

	<nav id="nav-menu" class="site-navigation main-navigation" role="navigation" aria-label="Main Navigation">
		<button id="nav-button" class="menu-toggle" role="button">
			<span class="screen-reader-text">Menu</span>
			<span class="genericon" aria-hidden="true"></span>
		</button>
		<ul id="primary-menu" class="primary-menu">
<li id="menu-item-3923" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-3923"><a href="/">Home</a></li>
<li id="menu-item-2051" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2051"><a href="/about-tester-stories/">About Tester Stories</a></li>
<li id="menu-item-2050" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2050"><a href="/who-am-i/">Who Am I</a></li>
<li id="menu-item-2048" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2048"><a href="/just-for-fun/">Just For Fun</a></li>
</ul>	</nav><!--/navigation-->


<form role="search" method="get" class="search-form" action="https://testerstories.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:">
	</label>
	<button type="submit" class="search-submit"><span class="genericon genericon-search" aria-hidden="true"></span><span class="screen-reader-text">Search</span></button>
</form>
</header><!--/header-->

<main id="main-content" class="main-content" role="main">
<article id="post-3242" class="post-3242 post type-post status-publish format-standard hentry category-machine-learning category-ml-series-2">
<header class="entry-header">
	<span class="entry-meta"><span class="cat-links"><span class="screen-reader-text">Published in</span><span class="genericon genericon-category" aria-hidden="true"></span><a href="/category/ai/machine-learning/" rel="category tag">Machine Learning</a><span aria-hidden="true">, </span><a href="/category/ai/machine-learning/ml-series-2/" rel="category tag">ML Series 2</a></span></span><h1 class="entry-title">The Tester Role in Machine Learning, Part 4</h1>	<span class="byline">
	Written by <a href="/author/administrator/" class="entry-author" rel="author">Jeff Nyman</a>	</span><!-- .byline -->
	<span class="entry-meta">
	<span class="genericon genericon-time" aria-hidden="true"></span><a href="/2017/12/04/" rel="bookmark" class="entry-date"><time datetime="2017-12-04T07:08:03-06:00">4 December 2017</time></a>		<span class="comments-link">
			<span class="genericon genericon-comment" aria-hidden="true"></span>
			<a href="/2017/12/the-tester-role-in-machine-learning-part-4/#comments">2 Comments</a>		</span>
		</span><!-- .entry-meta -->
</header><!-- .entry-header -->

	<div class="entry-content">
		<p>This is the last of a four part series (see parts <a href="/2017/12/the-tester-role-in-machine-learning-part-1/">1</a>, <a href="/2017/12/the-tester-role-in-machine-learning-part-2/">2</a> and <a href="/2017/12/the-tester-role-in-machine-learning-part-3/">3</a>). The goal has been investigating whether specialist testers have a role in machine learning environments uniquely distinct from development roles in those same environments. These posts have been getting you up to speed on what that might look like. Here we finish off that journey.</p>
<p><span id="more-3242"></span></p>
<p>In most of these posts, I&#8217;ve spent a lot of time going over details and taking you somewhat step-by-step through script creation because those scripts were acting as test harnesses. Along the way, I asked you to consider how much of that work you were actually doing, as a tester, as opposed to just having it handed to you.</p>
<p>For this final part, I&#8217;m actually going to give you the full scripts. How you got them is less important than what you do with them. Or, rather, how you consume the results from them. We already did testing as a design activity in a few of these posts. We did some testing as an execution activity as well, which we&#8217;ll continue a bit here. We also did a little &#8212; very little &#8212; of testing as a framing activity.</p>
<p>So you can run the provided scripts. You can see the results. And then we&#8217;ll regroup and think about what that part of the testing process means for you, as a specialist tester, and why this is testing as a framing activity.</p>
<h2>Some Dependencies</h2>
<p>For these scripts you will need another dependency beyond those we used already, which is a <a href="https://matplotlib.org/">matplotlib</a>. You can get this library by the following:</p>
<pre>pip install matplotlib</pre>
<p>This will be used so that we can draw some graphs. Currently we&#8217;ve been relying on text output but as we&#8217;ve seen, getting a whole bunch of data thrown back at us doesn&#8217;t really help us reason about the system all that much. In fact, as we saw, we couldn&#8217;t even necessarily tell if a bit of data indicated success or failure.</p>
<p>Finally, for the last of these examples, you will need TensorFlow installed. <a href="https://www.tensorflow.org/">TensorFlow</a> is library that allows for symbolic math. It&#8217;s name comes from the fact that it can perform computations with multi-dimensional data arrays which are commonly called tensors. Tensors take you into linear algebra and vector calculus, subjects I will tackle not at all here. To install it:</p>
<pre>pip install tensorflow</pre>
<p>Note that this will work just fine on a Mac or Linux. It <em>should</em> work okay on Windows &#8212; if you are using a 64-bit version of Python, as recommended in the first post. On a 32-bit version of Python, that might not work. If on Windows, your best bet is usually to use Python as part of a distribution like <a href="https://www.anaconda.com/download/">Anaconda</a> or the <a href="https://www.enthought.com/product/enthought-python-distribution/">Enthought</a> distribution. One thing you <em>can</em> do is try to download one of the <a href="https://pypi.python.org/pypi/tensorflow">TensorFlow wheels</a>. For example, download &#8220;tensorflow-1.4.0-cp36-cp36m-win_amd64.whl&#8221;, although the version number of TensorFlow might differ. Once you have that wheel downloaded, try this:</p>
<pre>pip install tensorflow-1.4.0-cp36-cp36m-win_amd64.whl</pre>
<p>If you are told that it&#8217;s &#8220;not a supported wheel on this platform&#8221;, you can try this next bit. Rename the wheel as follows:</p>
<pre>tensorflow-1.4.0-py3-none-any.whl</pre>
<p>Note the &#8220;-py3-none-any&#8221; which essentially replaces all other bits on that filename. Then try the pip installation again against this newly named file. That worked for me on Windows 8 and Windows 10. Keep in mind, even if all this works, this relies on certain DLL files in Windows and during execution you might find something reported like this: &#8220;DLL load failed: %1 is not a valid Win32 application.&#8221; If that happens, it probably means you are using a 32-bit Python while the binaries being called upon are 64-bit.</p>
<p>If all that seems a bit much, just try one of those distributions I mentioned or make sure you have a 64-bit Python installed.</p>
<h2>Test Scenarios</h2>
<p>We talked a few times about our test scenarios and what a &#8220;scenario&#8221; means in the context of this example. The notion of a scenario can take on varying levels of granularity in these kinds of environments. Here we&#8217;ll treat each algorithm &#8212; the strategy the agent uses to find a policy &#8212; as a test scenario. It is the outputs of those scenarios that we will be reasoning about.</p>
<p>The scenarios below are what I briefly covered in the last post from a conceptual point of view. Here we put them into action. In all cases, I&#8217;ll present the scripts with a few explanatory notes. Technically you don&#8217;t have to run them if you don&#8217;t want to. I say that because I am  going to come back and present their output to you. That said, I would certainly recommend running them and perhaps even annotating them with print statements if you want to see how things are operating.</p>
<h2>Test Scenario: Random Policy</h2>
<p>Here is <strong>cartpole-policy-random.py</strong>.</p>
<p></p>
<!-- Urvanov Syntax Highlighter v2.8.33 -->

		<div id="urvanov-syntax-highlighter-647f41fa4bdf6309769460" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;">
<span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;">
<div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<span class="crayon-language">Python</span>
</div>
</div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import gym
import numpy as np
import matplotlib.pyplot as plt

env = gym.make('CartPole-v0')

def create_policy():
    policy_parameters = np.random.rand(4)
    return (policy_parameters) * 2 - 1

def execute_policy(policy_parameters, observation):
    return 0 if np.matmul(policy_parameters, observation) &lt; 0 else 1

def run_episode(env, policy_parameters):
    observation = env.reset()
    total_reward = 0

    for _ in range(200):
        action = execute_policy(policy_parameters, observation)
        observation, reward, done, info = env.step(action)
        total_reward += reward

        if done:
            break

    return total_reward

def train_agent(env):
    all_rewards = []
    num_episodes = 0
    optional_params = None
    optimal_reward = 0

    for _ in range(10000):
        num_episodes += 1
        policy_params = create_policy()
        reward = run_episode(env, policy_params)
        all_rewards.append(reward)

        if reward &gt; optimal_reward:
            optimal_reward = reward
            optimal_params = policy_params

            if reward == 200:
                break

    return num_episodes

episodes_per_search = []
for _ in range(100):
    episodes_per_search.append(train_agent(env))

avg = np.mean(episodes_per_search)
print("Average number of episodes: {}".format(avg))

color = plt.get_cmap('bone')
plt.hist(episodes_per_search, facecolor='g', color=color(0.3), edgecolor='black', linewidth=1.1)
plt.plot([avg for _ in range(40)], np.linspace(0,40,40), color=color(0.7), linewidth=5)
plt.title('Histogram of Random Search Policy', fontsize=20)
plt.xlabel('Number of Episodes to Reach 200', fontsize=15)
plt.ylabel('Frequency of Episodes Reaching 200', fontsize=15)
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-1">1</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-2">2</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-3">3</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-4">4</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-5">5</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-6">6</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-7">7</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-8">8</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-9">9</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-10">10</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-11">11</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-12">12</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-13">13</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-14">14</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-15">15</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-16">16</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-17">17</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-18">18</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-19">19</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-20">20</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-21">21</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-22">22</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-23">23</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-24">24</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-25">25</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-26">26</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-27">27</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-28">28</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-29">29</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-30">30</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-31">31</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-32">32</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-33">33</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-34">34</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-35">35</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-36">36</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-37">37</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-38">38</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-39">39</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-40">40</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-41">41</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-42">42</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-43">43</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-44">44</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-45">45</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-46">46</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-47">47</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-48">48</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-49">49</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-50">50</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-51">51</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-52">52</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-53">53</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-54">54</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-55">55</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-56">56</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-57">57</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-58">58</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-59">59</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-60">60</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-61">61</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdf6309769460-62">62</div>
</div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;">
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-1">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">gym</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-2">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-3">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-4">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-5">
<span class="crayon-v">env</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gym</span><span class="crayon-sy">.</span><span class="crayon-e">make</span><span class="crayon-sy">(</span><span class="crayon-s">'CartPole-v0'</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-6">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-7">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">create_policy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-8">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">policy_parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-9">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-10">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-11">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">execute_policy</span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">observation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-12">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">matmul</span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">observation</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-13">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-14">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">run_episode</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-15">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">observation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">env</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-16">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">total_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-17">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-18">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-19">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">execute_policy</span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">observation</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-20">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">observation</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">info</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">env</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-21">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">total_reward</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-22">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-23">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-24">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-25">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-26">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">total_reward</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-27">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-28">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">train_agent</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-29">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">all_rewards</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-30">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num_episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-31">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optional_params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-32">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimal_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-33">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-34">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10000</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-35">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num_episodes</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-36">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">policy_params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_policy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-37">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">run_episode</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">policy_params</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-38">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">all_rewards</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">reward</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-39">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-40">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">optimal_reward</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-41">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimal_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-42">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimal_params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">policy_params</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-43">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-44">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-45">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-46">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-47">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">num_episodes</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-48">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-49">
<span class="crayon-v">episodes_per_search</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-50">
<span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-51">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">train_agent</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-52">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-53">
<span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-54">
<span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Average number of episodes: {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">avg</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-55">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-56">
<span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'bone'</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-57">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">facecolor</span><span class="crayon-o">=</span><span class="crayon-s">'g'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-e">color</span><span class="crayon-sy">(</span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">edgecolor</span><span class="crayon-o">=</span><span class="crayon-s">'black'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-o">=</span><span class="crayon-cn">1.1</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-58">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">avg </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">40</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-cn">40</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-e">color</span><span class="crayon-sy">(</span><span class="crayon-cn">0.7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-59">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Histogram of Random Search Policy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-60">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Number of Episodes to Reach 200'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-61">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Frequency of Episodes Reaching 200'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdf6309769460-62">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span>
</div>
</div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p></p>
<p>Here our agent is being trained and the <code>train_agent</code> method calls out to a <code>create_policy</code> method to get the specific algorithm that will handle this. Here it&#8217;s the random algorithm we were talking about in the last post. Each episode is a single execution of our learning algorithm. That&#8217;s what the <code>run_episode</code> method is doing. As you can see, 200 actions will be taken in the environment for each episode. The agent will train like this for 10,000 times.</p>
<p>Getting results is handled at the bottom. We&#8217;re training the agent 100 times and we&#8217;re doing this just to get some data for the graphs. But notice what we have here. We have the agent training being doing 100 times. For each training, the agent is running an episode 10,000 times. And each episode will consist of 200 steps.</p>
<p>That <code>run_episode</code> method can run multiple episodes with multiple random policies. That&#8217;s really important to understand. I say that because while this &#8220;random policy&#8221; approach may be one test scenario, there are actually thousands of test cases being executed! Remember that discussion we had previously about the domain-to-range ratio? Now you&#8217;re seeing a bit more of how that comes into play.</p>
<p>An episodes per search value is found and this is the number of episodes that it took to find each good policy. So what we&#8217;re asking here, as part of our results, is: &#8220;On average, it takes how many episodes to find a good policy that can get, in this case, a total reward of 200?&#8221;</p>
<p>Try it out!</p>
<h2>Test Scenario: Noisy Policy</h2>
<p>Here&#8217;s the next script, based on a hill-climbing style algorithm. This is <strong>cartpole-policy-noisy.py</strong>. This might take a little longer to run; perhaps about two to three minutes.</p>
<p></p>
<!-- Urvanov Syntax Highlighter v2.8.33 -->

		<div id="urvanov-syntax-highlighter-647f41fa4bdfd031280146" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;">
<span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;">
<div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<span class="crayon-language">Python</span>
</div>
</div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import gym
import numpy as np
import matplotlib.pyplot as plt

env = gym.make('CartPole-v0')

def create_policy():
    policy_parameters = np.random.rand(4)
    return (policy_parameters) * 2 - 1

def execute_policy(policy_parameters, observation):
    return 0 if np.matmul(policy_parameters, observation) &lt; 0 else 1

noise_scaler = 0.1

def noise_params(policy_params, noise_scaler):
    return policy_params + (np.random.rand(4) * 2 - 1) * noise_scaler

def run_episode(env, policy_parameters):
    observation = env.reset()
    total_reward = 0

    for _ in range(200):
        action = execute_policy(policy_parameters, observation)
        observation, reward, done, info = env.step(action)
        total_reward += reward

        if done:
            break

    return total_reward

def train_agent(env):
    num_episodes = 0
    optimal_reward = 0
    all_rewards = []
    policy_params = create_policy()

    for _ in range(10000):
        num_episodes += 1
        new_policy_params = noise_params(policy_params, noise_scaler)
        reward = run_episode(env, new_policy_params)
        all_rewards.append(reward)

        if reward &gt; optimal_reward:
            optimal_reward = reward
            policy_params = new_policy_params

            if reward == 200:
                break

    return num_episodes

episodes_per_search = []
for _ in range(100):
    episodes_per_search.append(train_agent(env))

episodes_per_search = np.array(episodes_per_search)
avg = np.mean(episodes_per_search)
print("Average number of episodes: {}".format(avg))

color = plt.get_cmap('bone')
plt.hist(episodes_per_search, facecolor='g', color=color(0.3), edgecolor='black', linewidth=1.1)
plt.plot([avg for _ in range(40)], np.linspace(0,40,40), color=color(0.7), linewidth=5)
plt.title('Histogram of Noisy Search Policy', fontsize=20)
plt.xlabel('Number of Episodes to Reach 200', fontsize=15)
plt.ylabel('Frequency of Episodes Reaching 200', fontsize=15)
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-1">1</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-2">2</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-3">3</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-4">4</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-5">5</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-6">6</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-7">7</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-8">8</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-9">9</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-10">10</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-11">11</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-12">12</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-13">13</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-14">14</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-15">15</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-16">16</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-17">17</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-18">18</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-19">19</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-20">20</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-21">21</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-22">22</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-23">23</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-24">24</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-25">25</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-26">26</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-27">27</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-28">28</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-29">29</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-30">30</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-31">31</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-32">32</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-33">33</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-34">34</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-35">35</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-36">36</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-37">37</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-38">38</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-39">39</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-40">40</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-41">41</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-42">42</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-43">43</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-44">44</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-45">45</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-46">46</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-47">47</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-48">48</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-49">49</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-50">50</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-51">51</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-52">52</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-53">53</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-54">54</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-55">55</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-56">56</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-57">57</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-58">58</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-59">59</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-60">60</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-61">61</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-62">62</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-63">63</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-64">64</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-65">65</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-66">66</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-67">67</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdfd031280146-68">68</div>
</div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;">
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-1">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">gym</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-2">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-3">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-4">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-5">
<span class="crayon-v">env</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gym</span><span class="crayon-sy">.</span><span class="crayon-e">make</span><span class="crayon-sy">(</span><span class="crayon-s">'CartPole-v0'</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-6">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-7">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">create_policy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-8">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">policy_parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-9">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-10">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-11">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">execute_policy</span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">observation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-12">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">matmul</span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">observation</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-13">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-14">
<span class="crayon-v">noise_scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-15">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-16">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">noise_params</span><span class="crayon-sy">(</span><span class="crayon-v">policy_params</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">noise_scaler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-17">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">policy_params</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">noise_scaler</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-18">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-19">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">run_episode</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-20">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">observation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">env</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-21">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">total_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-22">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-23">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-24">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">execute_policy</span><span class="crayon-sy">(</span><span class="crayon-v">policy_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">observation</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-25">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">observation</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">info</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">env</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-26">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">total_reward</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-27">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-28">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-29">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-30">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-31">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">total_reward</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-32">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-33">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">train_agent</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-34">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num_episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-35">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimal_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-36">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">all_rewards</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-37">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">policy_params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_policy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-38">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-39">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10000</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-40">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num_episodes</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-41">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_policy_params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">noise_params</span><span class="crayon-sy">(</span><span class="crayon-v">policy_params</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">noise_scaler</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-42">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">run_episode</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">new_policy_params</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-43">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">all_rewards</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">reward</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-44">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-45">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">optimal_reward</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-46">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optimal_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-47">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">policy_params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_policy_params</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-48">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-49">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-50">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-51">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-52">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">num_episodes</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-53">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-54">
<span class="crayon-v">episodes_per_search</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-55">
<span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-56">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">train_agent</span><span class="crayon-sy">(</span><span class="crayon-v">env</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-57">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-58">
<span class="crayon-v">episodes_per_search</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-59">
<span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-60">
<span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Average number of episodes: {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">avg</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-61">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-62">
<span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'bone'</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-63">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">episodes_per_search</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">facecolor</span><span class="crayon-o">=</span><span class="crayon-s">'g'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-e">color</span><span class="crayon-sy">(</span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">edgecolor</span><span class="crayon-o">=</span><span class="crayon-s">'black'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-o">=</span><span class="crayon-cn">1.1</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-64">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">avg </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">40</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-cn">40</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-e">color</span><span class="crayon-sy">(</span><span class="crayon-cn">0.7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-65">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Histogram of Noisy Search Policy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-66">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Number of Episodes to Reach 200'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-67">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Frequency of Episodes Reaching 200'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdfd031280146-68">
<span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span>
</div>
</div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0669 seconds] -->
<p></p>
<p>The basic idea here is that the reward derived is a function of those observation parameters. When we start with a policy that&#8217;s random, you are basically at what&#8217;s called a &#8220;local minimum&#8221; for the function.</p>
<p>Basically, functions can have &#8220;hills&#8221; and &#8220;valleys&#8221;, meaning places where the function reaches a minimum or maximum value. There is also the concept of an interval, which can be some segment of the overall values of a function. Each such interval can be considered a local maximum or minimum, where the local minimum means the &#8220;height&#8221; of the function at some point is greater than (or equal to) the height anywhere else in that interval.</p>
<p>So the local minimum for a random policy means that since you&#8217;ve started off with a random value it is, by definition, the minimum. So you are in the &#8220;valley&#8221; of the function and you want to go up to the &#8220;hills&#8221; &#8212; meaning go &#8220;up&#8221; the function, to higher values. Higher values, in this context, means a higher reward. That&#8217;s the &#8220;hill climbing&#8221; part. But if it&#8217;s all still random how does this work?</p>
<p>What the above does is add small changes to the parameters each time. These small changes are referred to as &#8220;noise.&#8221; If that small change leads to a better reward (moving up the function), the parameters are updated to incorporate those small changes. If, however, the change leads to less reward or even the same reward, then you try with different small changes.</p>
<h2>Test Scenario: Gradient Policy</h2>
<p>Finally, here is the script for <strong>cartpole-policy-gradient.py</strong>. The complexity in this approach compared to the others should be fairly obvious just by the nature of the script. I should note that this script will take longer to execute than the others. Depending on your computer, whether you are using CPU or GPU, and the version of TensorFlow, this can easily take anywhere from 10 to 25 minutes to run.</p>
<p></p>
<!-- Urvanov Syntax Highlighter v2.8.33 -->

		<div id="urvanov-syntax-highlighter-647f41fa4bdff910941076" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;">
<span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;">
<div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div>
<span class="crayon-language">Python</span>
</div>
</div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import gym
import random
import numpy as np
import tensorflow as tf
import matplotlib.pyplot as plt

env = gym.make('CartPole-v0')

def produce_observations(world_state, p_probs, p_state, session):
    total_reward = 0
    states = []
    actions = []
    transitions = []

    for _ in range(200):
        state_vector = world_state.reshape(1, -1)
        result = session.run(p_probs, feed_dict={p_state: state_vector})
        probabilities = result[0][0]
        action = create_policy(probabilities)
        states.append(world_state)
        action_taken = np.zeros(2)
        action_taken[action] = 1
        actions.append(action_taken)

        old_state = world_state
        world_state, reward, done, info =  env.step(action)
        transitions.append((old_state, action, reward))

        total_reward += reward

        if done:
            break

    return transitions, states, actions, total_reward, world_state

def produce_action_values(v_vals, v_state, world_state, transitions, session):
    advantages = []
    update_vals = []

    for i, transition in enumerate(transitions):
        obs, act, rew = transition
        discount = 0.03
        decrease = 1
        future_reward = 0

        for future_transition in transitions[i:]:
            future_reward += future_transition[2] * decrease
            decrease = decrease * (1 - discount)

        state_vector = world_state.reshape(1, -1)
        values_current = session.run(v_vals, feed_dict={v_state: state_vector})

        update_vals.append(future_reward)
        advantages.append(future_reward - values_current[0][0])

    return update_vals, advantages

def create_policy(probabilities):
    return 0 if random.uniform(0, 1) &lt; probabilities else 1

def update_value_function(update_vals, v_optimizer, v_state, v_new_vals, states, sess):
    update_vals_vector = np.array(update_vals).reshape(-1, 1)
    sess.run(v_optimizer, feed_dict={v_state: states, v_new_vals: update_vals_vector})

def update_policy_function(advantages, p_optimizer, p_state, p_advantages, p_actions, states, actions, sess):
    advantages_vector = np.array(advantages).reshape(-1, 1)
    sess.run(p_optimizer, feed_dict={p_state: states, p_advantages: advantages_vector, p_actions: actions})

def policy_function():
    with tf.variable_scope("policy"):
        params = tf.get_variable("policy_parameters", [4, 2])
        state = tf.placeholder(tf.float32, [None, 4])
        actions = tf.placeholder(tf.float32, [None, 2])
        advantages = tf.placeholder(tf.float32, [None, 1])

        policy_function = tf.matmul(state, params)
        probs = tf.nn.softmax(policy_function)
        good_probs = tf.reduce_sum(tf.multiply(probs, actions), reduction_indices=[1])
        log_probs = tf.log(good_probs) * advantages
        loss = -tf.reduce_sum(log_probs)
        optimizer = tf.train.AdamOptimizer(0.01).minimize(loss)

        return probs, state, actions, advantages, optimizer

def value_function():
    with tf.variable_scope("value"):
        state = tf.placeholder(tf.float32, [None,4])
        update_vals = tf.placeholder(tf.float32, [None, 1])

        w = tf.get_variable("w1", [4, 10])
        b = tf.get_variable("b1", [10])
        logits = tf.matmul(state, w) + b
        h = tf.nn.relu(logits)
        w = tf.get_variable("w2", [10, 1])
        b = tf.get_variable("b2", [1])
        calc_vals = tf.matmul(h, w) + b

        diffs = calc_vals - update_vals
        loss = tf.nn.l2_loss(diffs)
        optimizer = tf.train.AdamOptimizer(0.1).minimize(loss)

        return calc_vals, state, update_vals, optimizer, loss

def run_episode(env, session, policy_params, value_params):
    p_probs, p_state, p_actions, p_advantages, p_optimizer = policy_params
    v_vals, v_state, v_new_vals, v_optimizer, v_loss = value_params

    world_state = env.reset()

    transitions, states, actions, total_reward, world_state = produce_observations(world_state, p_probs, p_state, session)
    update_vals, advantages = produce_action_values(v_vals, v_state, world_state, transitions, session)

    update_value_function(update_vals, v_optimizer, v_state, v_new_vals, states, session)
    update_policy_function(advantages, p_optimizer, p_state, p_advantages, p_actions, states, actions, session)

    return total_reward

def train_agent():
    tf.reset_default_graph()
    policy_params = policy_function()
    value_params = value_function()

    session = tf.InteractiveSession()
    session.run(tf.global_variables_initializer())

    num_episodes = 0
    all_rewards = []

    for _ in range(2000):
        num_episodes += 1
        reward = run_episode(env, session, policy_params, value_params)
        all_rewards.append(reward)

        if reward == 200:
            break

    return num_episodes

episodes_per_search = []
for _ in range(100):
    episodes_per_search.append(train_agent())

avg = np.mean(episodes_per_search)
print("Average number of episodes: {}".format(avg))

color = plt.get_cmap('bone')
plt.hist(episodes_per_search, facecolor='g', color=color(0.3), edgecolor='black', linewidth=1.1)
plt.plot([avg for _ in range(40)], np.linspace(0,40,40), color=color(0.7), linewidth=5)
plt.title('Histogram of Gradient Search Policy', fontsize=20)
plt.xlabel('Number of Episodes to Reach 200', fontsize=15)
plt.ylabel('Frequency of Episodes Reaching 200', fontsize=15)
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-1">1</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-2">2</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-3">3</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-4">4</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-5">5</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-6">6</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-7">7</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-8">8</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-9">9</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-10">10</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-11">11</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-12">12</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-13">13</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-14">14</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-15">15</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-16">16</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-17">17</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-18">18</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-19">19</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-20">20</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-21">21</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-22">22</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-23">23</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-24">24</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-25">25</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-26">26</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-27">27</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-28">28</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-29">29</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-30">30</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-31">31</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-32">32</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-33">33</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-34">34</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-35">35</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-36">36</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-37">37</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-38">38</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-39">39</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-40">40</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-41">41</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-42">42</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-43">43</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-44">44</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-45">45</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-46">46</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-47">47</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-48">48</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-49">49</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-50">50</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-51">51</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-52">52</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-53">53</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-54">54</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-55">55</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-56">56</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-57">57</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-58">58</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-59">59</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-60">60</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-61">61</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-62">62</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-63">63</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-64">64</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-65">65</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-66">66</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-67">67</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-68">68</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-69">69</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-70">70</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-71">71</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-72">72</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-73">73</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-74">74</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-75">75</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-76">76</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-77">77</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-78">78</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-79">79</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-80">80</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-81">81</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-82">82</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-83">83</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-84">84</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-85">85</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-86">86</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-87">87</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-88">88</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-89">89</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-90">90</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-91">91</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-92">92</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-93">93</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-94">94</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-95">95</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-96">96</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-97">97</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-98">98</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-99">99</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-100">100</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-101">101</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-102">102</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-103">103</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-104">104</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-105">105</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-106">106</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-107">107</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-108">108</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-109">109</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-110">110</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-111">111</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-112">112</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-113">113</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-114">114</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-115">115</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-116">116</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-117">117</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-118">118</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-119">119</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-120">120</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-121">121</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-122">122</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-123">123</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-124">124</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-125">125</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-126">126</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-127">127</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-128">128</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-129">129</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-130">130</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-131">131</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-132">132</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-133">133</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-134">134</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-135">135</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-136">136</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-137">137</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-138">138</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-139">139</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-140">140</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-141">141</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-142">142</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-143">143</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-144">144</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-145">145</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-146">146</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-147">147</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-148">148</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-149">149</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-150">150</div>
<div class="crayon-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-151">151</div>
<div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-647f41fa4bdff910941076-152">152</div>
</div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;">
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-1">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">gym</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-2">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">random</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-3">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-4">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">tensorflow </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">tf</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-5">
<span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-6">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-7">
<span class="crayon-v">env</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gym</span><span class="crayon-sy">.</span><span class="crayon-e">make</span><span class="crayon-sy">(</span><span class="crayon-s">'CartPole-v0'</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-8">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-9">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">produce_observations</span><span class="crayon-sy">(</span><span class="crayon-v">world_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_probs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">session</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-10">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">total_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-11">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">states</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-12">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">actions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-13">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">transitions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-14">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-15">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-16">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">world_state</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-17">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">session</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-v">p_probs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">feed_dict</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-v">p_state</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">state_vector</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-18">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-19">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_policy</span><span class="crayon-sy">(</span><span class="crayon-v">probabilities</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-20">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">states</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">world_state</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-21">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action_taken</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-22">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action_taken</span><span class="crayon-sy">[</span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-23">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">actions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">action_taken</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-24">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-25">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">old_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">world_state</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-26">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">world_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">info</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">env</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-27">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">transitions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">old_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-28">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-29">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">total_reward</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-30">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-31">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-32">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-33">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-34">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">transitions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">states</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">actions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">total_reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">world_state</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-35">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-36">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">produce_action_values</span><span class="crayon-sy">(</span><span class="crayon-v">v_vals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">world_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">transitions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">session</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-37">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">advantages</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-38">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">update_vals</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-39">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-40">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">transition </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">transitions</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-41">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">obs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">act</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rew</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transition</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-42">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">discount</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.03</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-43">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">decrease</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-44">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">future_reward</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-45">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-46">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">future_transition </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">transitions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-47">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">future_reward</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">future_transition</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">decrease</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-48">
<span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">decrease</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">decrease</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">discount</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-49">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-50">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">world_state</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-51">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">values_current</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">session</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-v">v_vals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">feed_dict</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-v">v_state</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">state_vector</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-52">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-53">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">update_vals</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">future_reward</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-54">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">advantages</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">future_reward</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">values_current</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-55">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-56">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">update_vals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">advantages</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-57">&nbsp;</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-58">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">create_policy</span><span class="crayon-sy">(</span><span class="crayon-v">probabilities</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-59">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">uniform</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">probabilities </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-60">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-61">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">update_value_function</span><span class="crayon-sy">(</span><span class="crayon-v">update_vals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v_optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v_new_vals</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">states</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sess</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-62">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">update_vals_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">update_vals</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-63">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sess</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-v">v_optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">feed_dict</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-v">v_state</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">states</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v_new_vals</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">update_vals_vector</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-64">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-65">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">update_policy_function</span><span class="crayon-sy">(</span><span class="crayon-v">advantages</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_advantages</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_actions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">states</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">actions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sess</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-66">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">advantages_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">advantages</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-67">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sess</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-v">p_optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">feed_dict</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-v">p_state</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">states</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_advantages</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">advantages_vector</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_actions</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">actions</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-68">&nbsp;</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-69">
<span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">policy_function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-70">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">variable_scope</span><span class="crayon-sy">(</span><span class="crayon-s">"policy"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-71">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">get_variable</span><span class="crayon-sy">(</span><span class="crayon-s">"policy_parameters"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-72">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">placeholder</span><span class="crayon-sy">(</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span>
</div>
<div class="crayon-line" id="urvanov-syntax-highlighter-647f41fa4bdff910941076-73">
<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">actions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">placeholder</span><span class="crayon-sy">(</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">float32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span>
</div>
</div></td>
</tr>
</table>
</div>
</div>
</div></article></main>
</div>
</body>
</html>